<!--
  build_ module v0.1
-->

<script>
  build = {};

  build.input_panel = function(panel_map){
    clog('building input panel...');
    var ids, input_part, submit, clear, buttons, action_part;
    ids = panel_map.inputs.allIds;
    buttons = panel_map.buttons;
    input_part = ids.map(function(id){
      var h, html;
      h = panel_map.inputs.byId[id];
      html = h.label + ':';
      switch (h.type){
      case 'label':
        html = wrap.in_tag('div', {id:h.id}, h.label);
        return html;
        break;
      case 'number':
      case 'text':
        html += gen.input(_.extend({}, h.attr, {id:id, value:h.dflt}));
        html += wrap.in_tag('div', {id:'err_' + id, class:'err'}, '');
        return html;
        break;
      case 'selector':
        html += wrap.in_tag('select', _.extend({}, h.attr, {id:id}), h.options);
        return html;
        break;
      case 'checkbox':
        html += gen.input(_.extend({}, h.attr, {id:id, type:'checkbox'}), 'checked');
        return html;
        break;
      };
      return html;
    }).join('<br>');
    action_part = buttons.map(function(x){
      return wrap.in_tag('button', {id:x.id, class:'full'}, x.label);
    });
    return input_part + action_part;
  };

  NEW_SLOT_INPUTS = {
    byId:{
      brief: {
        dflt: '',
        canonize:function(x){return x;},
        validation_rule:function(x){return true;},
        invalid_data_message:'Must be in tags language',
        label:'Brief',
        type:'text',
        attr:{type:'text', class:'full'}},

      description: {
        dflt:'autogenerated',
        canonize:function(x){return x;},
        validation_rule:function(x){return true;},
        invalid_data_message:'this message must never been shown',
        label:'Description',
        type:'text',
        attr:{type:'text', class:'full'}},

      parent_code: {
        dflt:'0',
        canonize:function(x){return x;},
        validation_rule:is.num,
        invalid_data_message:'Must be a number',
        label:'Parent target code',
        type:'number',
        attr:{type:'number', class:'full'}},

      life_time: {
        type:'selector',
        options: gen.lifetime_options,
        label:'Life time'
      },

      active: {
        type:'checkbox',
        label: 'Active',
        dflt:true
      },
      add_trigger: {
        type:'label',
        label:'Triggers'
      },
      group_type: {
        type:'selector',
        options: gen.trigger_types,
        label:'Add trigger of type'
      }

    },

    allIds:['brief', 'description', 'parent_code', 'life_time', 'active','add_trigger', 'group_type']

};


  NEW_SLOTS_INPUT_PANEL = {
    inputs: NEW_SLOT_INPUTS,
    buttons: [{id:'submit', class:'button full', label:'Submit'}]
  };

</script>